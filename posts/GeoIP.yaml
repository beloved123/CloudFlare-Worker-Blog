port: 7890
socks-port: 7891
allow-lan: true
mode: Rule
log-level: info
external-controller: :9090
secret: ''
ipv6: true


dns:
  enable: true
  ipv6: true
  listen: 0.0.0.0:53
  enhanced-mode: redir-host
#  fake-ip-range: 198.18.0.1/16
#  fake-ip-filter:
#    - '*.lan'
#    - localhost.ptlogin2.qq.com
#DNS BootStar,引导Doh、Dot服务
  default-nameserver:
    - 114.114.114.114
    - 223.5.5.5
    - 1.1.1.1
    - 8.8.8.8
#首选DNS，最终解析结果会与Fallback验证，建议使用国内Doh
  nameserver:
#国内Doh
#    - https://dns.alidns.com/dns-query
#    - https://doh.pub/dns-query
#    - https://dns.rubyfish.cn/dns-query
#    - https://ea-dns.rubyfish.cn/dns-query
#    - https://uw-dns.rubyfish.cn/dns-query
    - https://doh.360.cn/dns-query
#    - https://i.233py.com/dns-query
#    - https://dns.233py.com/dns-query
#    - https://101.6.6.6:8443/dns-query
#国外Doh
    - https://doh.dns.sb/dns-query
    - https://dns.cloudflare.com/dns-query
    - https://doh.opendns.com/dns-query
    - https://dns-unfiltered.adguard.com/dns-query
    - https://dns.nextdns.io/dnscrypt-proxy
    - https://dns10.quad9.net/dns-query
    - https://doh.crypto.sx/dns-query
    - https://dns.containerpi.com/dns-query
    - https://dns.pumplex.com/dns-query
    - https://doh.rixcloud.dev/dns-query

#Dot是固定端口，所有国内Dot服务都可能被拦截，建议使用Doh
#国内Dot
#    - tls://dns.sb:853
#    - tls://dns.pub:853
#    - tls://dns.alidns.com:853
#    - tls://ea-dns.rubyfish.cn:853
#    - tls://uw-dns.rubyfish.cn:853

#国外Dot
#    - tls://1dot1dot1dot1.cloudflare-dns.com:853
#    - tls://dns-unfiltered.adguard.com:853
#    - tls://dot.360.cn:853
#    - tls://dns.google:853
#回环DNS，所有Nameserver解析结果会与Fallback验证
  fallback:
    - https://dns.cloudflare.com/dns-query
    - https://dns-unfiltered.adguard.com/dns-query
    - https://dns.google.com/dns-query
#    - tls://dns.google:853
  fallback-filter:
    geoip: true
#    ipcidr:
#    - 240.0.0.0/4
  experimental:
    ignore-resolve-fail: true
    
  interface-name:
  
proxy-providers:
  GeoIP-Proxy:
    type: http
    path: ./Proxy-Providers/GeoIP-proxy-providers.yaml
    url: https://cors.buildtest.site/https://raw.githubusercontent.com/LittleRey/CloudFlare-Worker-Blog/master/posts/providers/GeoIP-proxy-providers.yaml
    interval: 3600
    health-check:
      enable: true
      url: https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png
      interval: 300
      
      
  Fly1-Proxy:
    type: http
    path: ./Proxy-Providers/Fly1-proxy-providers.yaml
    url: https://cors.buildtest.site/https://api.wcc.best/sub?target=clash&url=https%3A%2F%2Fsubscribe.connect-node.xyz%2Flink%2FYXbh1yXhsY4XcV68%3Fsub%3D3&insert=false&emoji=true&list=true&udp=false&tfo=false&scv=false&fdn=false&sort=false&new_name=true
    interval: 3600
    health-check:
      enable: true
      url: https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png
      interval: 300
      

  NeteaseUnblock:
    type: http
    path: ./Proxy-Providers/NeteaseUnblock-proxy-providers.yaml
    url: https://cors.buildtest.site/https://raw.githubusercontent.com/LittleRey/CloudFlare-Worker-Blog/master/posts/providers/NeteaseUnblock-proxy-providers.yaml
    interval: 3600
    health-check:
      enable: true
      url: http://music.163.com
      interval: 300


proxy-groups:

  - name: 国外代理
    type: select
    use:
      - GeoIP-Proxy
      - Fly1-Proxy
    proxies:
      - 延迟测试
      - DIRECT


      
  - name: 延迟测试
    type: url-test
    url: https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png
    interval: 300
    use:
      - GeoIP-Proxy
      - Fly1-Proxy

  
#  - name: DnsBlock
#    type: select
#    proxies:
#      - REJECT



  - name: 网易云音乐
    type: select
    use:
      - NeteaseUnblock
    proxies:
      - DIRECT
    


  - name: 国内直连
    type: select
    use:
      - GeoIP-Proxy
      - Fly1-Proxy
    proxies:
      - DIRECT
      - 国外代理



  - name: 漏网之鱼
    type: select
    use:
      - GeoIP-Proxy
      - Fly1-Proxy
    proxies:
      - DIRECT
      - 国外代理


rule-providers:

  DirectConnect:
    type: http
    behavior: classical
    path: ./Rule-Providers/Direct.list
    url: https://cors.buildtest.site/https://raw.githubusercontent.com/LittleRey/CloudFlare-Worker-Blog/master/posts/rules/Direct.list
    interval: 3600


  Proxy:
    type: http
    behavior: classical
    path: ./Rule-Providers/Proxy.list
    url: https://cors.buildtest.site/https://raw.githubusercontent.com/LittleRey/CloudFlare-Worker-Blog/master/posts/rules/Proxy.list
    interval: 3600


  NeteaseMusic:
    type: http
    behavior: classical
    path: ./Rule-Providers/NeteaseMusic.list
    url: https://cors.buildtest.site/https://raw.githubusercontent.com/LittleRey/CloudFlare-Worker-Blog/master/posts/rules/NeteaseMusic.list
    interval: 3600



  NeteaseMedia:
    type: http
    behavior: classical
    path: ./Rule-Providers/NeteaseMedia.list
    url: https://cors.buildtest.site/https://raw.githubusercontent.com/LittleRey/CloudFlare-Worker-Blog/master/posts/rules/NeteaseMedia.list
    interval: 3600
    
    

  GeoIP:
    type: http
    behavior: classical
    path: ./Rule-Providers/GeoIP.list
    url: https://cors.buildtest.site/https://raw.githubusercontent.com/LittleRey/CloudFlare-Worker-Blog/master/posts/rules/GeoIP.list
    interval: 3600





rules:
 - RULE-SET,NeteaseMedia,国内直连
 - RULE-SET,NeteaseMusic,网易云音乐
 - RULE-SET,DirectConnect,国内直连
 - RULE-SET,Proxy,国外代理
 - RULE-SET,GeoIP,国外代理

#剩余直连
 - MATCH,漏网之鱼
